{"eventType":"EntityCreated","entityType":"domain","entityId":"Command","timestamp":"2026-01-21T13:07:49.296Z","version":1,"payload":{"name":"Command","description":"A bash command executed in Claude Code with metadata (description, cwd, stdout, stderr, timestamp, session_id). The core entity that users search and browse.","files":["src/db.ts"]}}
{"eventType":"EntityCreated","entityType":"domain","entityId":"Session","timestamp":"2026-01-21T13:07:49.433Z","version":1,"payload":{"name":"Session","description":"A Claude Code conversation session containing multiple tool uses and commands. Sessions are stored as JSONL files in ~/.claude/projects/.","files":["src/sync.ts"]}}
{"eventType":"EntityCreated","entityType":"domain","entityId":"Index","timestamp":"2026-01-21T13:07:49.579Z","version":1,"payload":{"name":"Index","description":"The SQLite database storing indexed commands with FTS5 full-text search. Located at ~/.cc-dejavu/history.db.","files":["src/db.ts"]}}
{"eventType":"EntityCreated","entityType":"capability","entityId":"SearchCommands","timestamp":"2026-01-21T13:08:00.417Z","version":1,"payload":{"name":"SearchCommands","description":"Search command history using substring or regex patterns. Returns ranked results with match highlighting.","operates_on":["Command","Index"],"files":["src/commands/search.ts"]}}
{"eventType":"EntityCreated","entityType":"capability","entityId":"ListCommands","timestamp":"2026-01-21T13:08:00.562Z","version":1,"payload":{"name":"ListCommands","description":"List recent commands ordered by frecency or timestamp. Supports directory filtering.","operates_on":["Command","Index"],"files":["src/commands/list.ts"]}}
{"eventType":"EntityCreated","entityType":"capability","entityId":"SyncHistory","timestamp":"2026-01-21T13:08:00.704Z","version":1,"payload":{"name":"SyncHistory","description":"Scan Claude Code session files and extract bash commands into the index. Supports incremental and force modes.","operates_on":["Session","Command","Index"],"files":["src/sync.ts","src/commands/syncCmd.ts"]}}
{"eventType":"EntityCreated","entityType":"capability","entityId":"OnboardUser","timestamp":"2026-01-21T13:08:00.844Z","version":1,"payload":{"name":"OnboardUser","description":"Add deja documentation to ~/.claude/CLAUDE.md so Claude knows how to use command history search.","operates_on":["Session"],"files":["src/commands/onboard.ts"]}}
{"eventType":"EntityCreated","entityType":"capability","entityId":"ParseSessionFiles","timestamp":"2026-01-21T13:08:00.987Z","version":1,"payload":{"name":"ParseSessionFiles","description":"Parse JSONL session files, extract tool_use and tool_result pairs, and structure them as ParsedCommand objects.","operates_on":["Session","Command"],"files":["src/sync.ts"]}}
{"eventType":"EntityCreated","entityType":"capability","entityId":"FormatOutput","timestamp":"2026-01-21T13:08:01.129Z","version":1,"payload":{"name":"FormatOutput","description":"Format command results for terminal display with status indicators, timestamps, descriptions, and match highlighting.","operates_on":["Command"],"files":["src/format.ts"]}}
{"eventType":"EntityCreated","entityType":"aspect","entityId":"FullTextSearch","timestamp":"2026-01-21T13:08:09.571Z","version":1,"payload":{"name":"FullTextSearch","description":"FTS5 virtual table with BM25 ranking for semantic command matching. Indexes command text and description.","applies_to":{"capabilities":["SearchCommands","Index"]},"files":["src/db.ts"]}}
{"eventType":"EntityCreated","entityType":"aspect","entityId":"FrecencyRanking","timestamp":"2026-01-21T13:08:09.726Z","version":1,"payload":{"name":"FrecencyRanking","description":"Combines frequency (log10 scaling) with recency (time-decay weights: 4h=100, 24h=70, 7d=50, 30d=30, older=10) for intelligent result ranking.","applies_to":{"capabilities":["SearchCommands","ListCommands","Command"]},"files":["src/frecency.ts"]}}
{"eventType":"EntityCreated","entityType":"aspect","entityId":"IncrementalSync","timestamp":"2026-01-21T13:08:09.881Z","version":1,"payload":{"name":"IncrementalSync","description":"Tracks file byte offsets in indexed_files table to resume syncing from where we left off, avoiding re-processing.","applies_to":{"capabilities":["SyncHistory","Session"]},"files":["src/sync.ts","src/db.ts"]}}
{"eventType":"EntityCreated","entityType":"decision","entityId":"dec-1769000902441","timestamp":"2026-01-21T13:08:22.441Z","version":1,"payload":{"id":"dec-1769000902441","what":"Use SQLite with FTS5 for local search","why":"Provides fast full-text search with BM25 ranking without external dependencies. Single file database is portable and privacy-preserving.","when":"2026-01-21T13:08:22.441Z","status":"active","relates_to":{}}}
{"eventType":"EntityCreated","entityType":"decision","entityId":"dec-1769000902596","timestamp":"2026-01-21T13:08:22.596Z","version":1,"payload":{"id":"dec-1769000902596","what":"Use Bun runtime instead of Node.js","why":"Native TypeScript execution, built-in SQLite bindings, fast compilation to standalone binaries for distribution.","when":"2026-01-21T13:08:22.596Z","status":"active","relates_to":{}}}
{"eventType":"EntityCreated","entityType":"decision","entityId":"dec-1769000902742","timestamp":"2026-01-21T13:08:22.742Z","version":1,"payload":{"id":"dec-1769000902742","what":"Implement frecency algorithm for ranking","why":"Combines frequency and recency to surface both commonly-used and recently-used commands. Borrowed from browser URL bars.","when":"2026-01-21T13:08:22.742Z","status":"active","relates_to":{}}}
{"eventType":"EntityCreated","entityType":"decision","entityId":"dec-1769000902891","timestamp":"2026-01-21T13:08:22.891Z","version":1,"payload":{"id":"dec-1769000902891","what":"Track byte offsets for incremental sync","why":"Session files can be large. By tracking last byte offset, we only parse new content on subsequent syncs.","when":"2026-01-21T13:08:22.891Z","status":"active","relates_to":{}}}
{"eventType":"EntityCreated","entityType":"decision","entityId":"dec-1769000903042","timestamp":"2026-01-21T13:08:23.042Z","version":1,"payload":{"id":"dec-1769000903042","what":"Local-only, read-only architecture","why":"Privacy-first design. Never modifies Claude session files. No cloud sync. All data stays on user machine.","when":"2026-01-21T13:08:23.042Z","status":"active","relates_to":{}}}
{"eventType":"EntityCreated","entityType":"decision","entityId":"dec-1769000903192","timestamp":"2026-01-21T13:08:23.192Z","version":1,"payload":{"id":"dec-1769000903192","what":"Auto-sync before search/list operations","why":"Ensures results are always up-to-date without requiring manual sync. Can be disabled with --no-sync flag.","when":"2026-01-21T13:08:23.192Z","status":"active","relates_to":{}}}
